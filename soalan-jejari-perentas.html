<!DOCTYPE html>
<html lang="ms">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Kuiz Ciri Bulatan (Canvas JS)</title>
<style>
  :root { --card:#fff; --ink:#2c3e50; --accent:#f39c12; }
  body{
    font-family: "Arial Black", sans-serif;
    background: linear-gradient(135deg,#1a1a2e,#16213e);
    color:#fff; margin:0; padding:24px; min-height:100vh;
    display:flex; align-items:center; justify-content:center;
  }
  .wrap{
    width: min(960px, 95vw);
    background: rgba(255,255,255,0.95);
    color:#000; border-radius:18px; padding:24px;
    box-shadow: 0 20px 40px rgba(0,0,0,.25);
  }
  .head{ display:flex; align-items:center; gap:12px; }
  .head h1{ color:var(--accent); margin:0; font-size:1.8rem; }
  .meta{ color:#666; margin:4px 0 16px; }
  .qwrap{ display:grid; grid-template-columns: 1fr 360px; gap:18px; }
  @media (max-width: 800px){ .qwrap{ grid-template-columns: 1fr; } }
  canvas{
    width:100%; height:auto; background:#f5e6d3;
    border:3px solid var(--accent); border-radius:12px;
  }
  .prompt{ font-size:1.1rem; line-height:1.5; }
  .opts{ margin-top:12px; display:grid; gap:10px; }
  .opts label{
    border:2px solid #ccd; border-radius:10px; padding:10px 12px;
    display:flex; gap:10px; align-items:center; cursor:pointer;
    transition: transform .1s ease;
  }
  .opts label:hover{ transform: translateY(-2px); }
  .opts input{ transform: scale(1.2); }
  .controls{ display:flex; gap:10px; flex-wrap:wrap; margin-top:16px; }
  button{
    border:none; padding:12px 18px; border-radius:10px; color:#fff;
    font-weight:bold; cursor:pointer;
  }
  .btn-primary{ background: linear-gradient(135deg,#3498db,#2980b9); }
  .btn-ok{ background: linear-gradient(135deg,#27ae60,#2ecc71); }
  .btn-warn{ background: linear-gradient(135deg,#e67e22,#d35400); }
  .btn-ghost{ background: linear-gradient(135deg,#8e44ad,#9b59b6); }
  .feedback{ margin-top:10px; font-weight:bold; }
  .ok{ color:#27ae60; } .bad{ color:#e74c3c; }
  .scorebox{ margin-top:8px; color:#333; }
</style>
</head>
<body>
  <div class="wrap">
    <div class="head">
      <h1>Kuiz Ciri Bulatan (Canvas)</h1>
    </div>
    <div class="meta">Semua rajah dilukis dengan JavaScript Canvas. Pilih jawapan terbaik.</div>

    <div class="qwrap">
      <div>
        <div id="qnum" class="meta"></div>
        <div id="prompt" class="prompt"></div>
        <div id="options" class="opts"></div>
        <div class="controls">
          <button id="checkBtn" class="btn-ok">Semak Jawapan</button>
          <button id="prevBtn" class="btn-primary">Sebelumnya</button>
          <button id="nextBtn" class="btn-warn">Seterusnya</button>
          <button id="restartBtn" class="btn-ghost">Tunjuk Jalan Kira</button>
        </div>
        <div id="feedback" class="feedback"></div>
        <div id="score" class="scorebox"></div>
      </div>
      <div>
        <canvas id="cv" width="500" height="400"></canvas>
      </div>
    </div>
  </div>

<script>
/* ===== util canvas ===== */
const cv = document.getElementById('cv');
const ctx = cv.getContext('2d');
const W = cv.width, H = cv.height;
function resetCanvas(){
  ctx.clearRect(0,0,W,H);
  ctx.lineCap='round'; ctx.lineJoin='round';
}
const deg = a => a * Math.PI/180;

/* ===== bank soalan ===== */
const questions = [
  // 1. DIAMETER
  {
    prompt: "Rajah menunjukkan bulatan berpusat O. Jika jejari OA = 5 cm, berapakah panjang diameter AB?",
    options: ["5 cm","8 cm","10 cm","12 cm"],
    correctIndex: 2,
    draw: () => {
      resetCanvas();
      const cx=250, cy=200, r=120;
      ctx.beginPath(); ctx.arc(cx,cy,r,0,Math.PI*2);
      ctx.strokeStyle="#2c3e50"; ctx.lineWidth=3; ctx.stroke();
      ctx.beginPath(); ctx.moveTo(cx-r,cy); ctx.lineTo(cx+r,cy);
      ctx.strokeStyle="#e74c3c"; ctx.lineWidth=5; ctx.stroke();
      ctx.beginPath(); ctx.moveTo(cx,cy); ctx.lineTo(cx+r,cy);
      ctx.setLineDash([6,6]); ctx.strokeStyle="#27ae60"; ctx.lineWidth=3; ctx.stroke(); ctx.setLineDash([]);
      ctx.fillStyle="#000"; ctx.font="bold 16px Arial";
      ctx.fillText("A", cx-r-14, cy+6);
      ctx.fillText("B", cx+r+6, cy+6);
      ctx.fillText("O", cx-7, cy-10);
      ctx.fillText("Jejari = 5 cm", cx+20, cy-10);
    }
  },

  // 2. JEJARI SERENJANG PERENTAS
  {
    prompt: "Jejari OC berserenjang dengan perentas AB di titik tengah. Jika jejari r = 10 cm dan OC = 4 cm, berapakah panjang perentas AB?",
    options: ["16.0 cm","18.3 cm","20.0 cm","8.0 cm"],
    correctIndex: 1,
    draw: () => {
      resetCanvas();
      const cx=250, cy=180, r=120;
      ctx.beginPath(); ctx.arc(cx,cy,r,0,2*Math.PI);
      ctx.strokeStyle="#2c3e50"; ctx.lineWidth=3; ctx.stroke();

      const d = 48;
      const y = cy + d;
      const half = Math.sqrt(r*r - d*d);
      const Ax = cx - half, Bx = cx + half;

      ctx.beginPath(); ctx.moveTo(Ax,y); ctx.lineTo(Bx,y);
      ctx.strokeStyle="#8e44ad"; ctx.lineWidth=5; ctx.stroke();

      ctx.beginPath(); ctx.moveTo(cx,cy); ctx.lineTo(cx,y);
      ctx.setLineDash([6,6]); ctx.strokeStyle="#27ae60"; ctx.lineWidth=3; ctx.stroke(); ctx.setLineDash([]);

      ctx.save(); ctx.translate(cx,y);
      ctx.beginPath(); ctx.moveTo(-10,0); ctx.lineTo(10,0);
      ctx.strokeStyle="#e74c3c"; ctx.lineWidth=3; ctx.stroke(); ctx.restore();

      ctx.fillStyle="#000"; ctx.font="bold 16px Arial";
      ctx.fillText("A", Ax-14, y+6);
      ctx.fillText("B", Bx+6, y+6);
      ctx.fillText("O", cx-8, cy-8);
      ctx.fillText("C", cx-8, y+18);
      ctx.fillText("r = 10 cm", cx+20, cy-12);
      ctx.fillText("OC = 4 cm", cx+20, (cy+y)/2 );
    }
  },

  // 3. JARAK PUSAT KE PERENTAS
  {
    prompt: "Bulatan berpusat O mempunyai jejari r = 10 cm. Jika perentas AB = 12 cm, berapakah jarak perentas itu dari pusat (OC)?",
    options: ["10 cm","8 cm","6 cm","4 cm"],
    correctIndex: 1,
    draw: () => {
      resetCanvas();
      const cx=250, cy=190, r=120;
      ctx.beginPath(); ctx.arc(cx,cy,r,0,2*Math.PI);
      ctx.strokeStyle="#2c3e50"; ctx.lineWidth=3; ctx.stroke();

      const half = 72;
      const d = Math.sqrt(r*r - half*half);
      const y = cy + d;
      const Ax = cx - half, Bx = cx + half;

      ctx.beginPath(); ctx.moveTo(Ax,y); ctx.lineTo(Bx,y);
      ctx.strokeStyle="#9b59b6"; ctx.lineWidth=5; ctx.stroke();

      ctx.beginPath(); ctx.moveTo(cx,cy); ctx.lineTo(cx,y);
      ctx.setLineDash([6,6]); ctx.strokeStyle="#27ae60"; ctx.lineWidth=3; ctx.stroke(); ctx.setLineDash([]);

      ctx.fillStyle="#000"; ctx.font="bold 16px Arial";
      ctx.fillText("A", Ax-14, y+6);
      ctx.fillText("B", Bx+6, y+6);
      ctx.fillText("O", cx-8, cy-8);
      ctx.fillText("r = 10 cm", cx+20, cy-12);
      ctx.fillText("AB = 12 cm", cx+20, y+22);
      ctx.fillText("OC = ?", cx+20, (cy+y)/2 );
    }
  }
];

/* ===== state & UI ===== */
let idx = 0;
let score = 0;
const params = new URLSearchParams(window.location.search);
if(params.has('question')){
  idx = parseInt(params.get('question'));
}
const answered = new Array(questions.length).fill(null);

const qnum = document.getElementById('qnum');
const promptEl = document.getElementById('prompt');
const optsEl = document.getElementById('options');
const feedback = document.getElementById('feedback');
const scoreBox = document.getElementById('score');
const btnPrev = document.getElementById('prevBtn');
const btnNext = document.getElementById('nextBtn');
const btnCheck = document.getElementById('checkBtn');
const btnRestart = document.getElementById('restartBtn');

function render(){
  const q = questions[idx];
  qnum.textContent = `Soalan ${idx+1} / ${questions.length}`;
  promptEl.textContent = q.prompt;
  optsEl.innerHTML = '';
  q.options.forEach((t,i)=>{
    const row=document.createElement('label');
    row.innerHTML = `<input type="radio" name="opt" value="${i}"> <span>${t}</span>`;
    optsEl.appendChild(row);
  });
  if(answered[idx]!==null){
    const saved=answered[idx];
    const inp=optsEl.querySelector(`input[value="${saved.sel}"]`);
    if(inp) inp.checked=true;
    setFeedback(saved.correct);
  } else { setFeedback(null); }
  q.draw();
  btnPrev.disabled = idx===0;
  btnNext.disabled = idx===questions.length-1;
  scoreBox.textContent=`Markah semasa: ${score} / ${questions.length}`;
}

function getSelected(){
  const el=optsEl.querySelector('input[name="opt"]:checked');
  return el ? parseInt(el.value,10) : null;
}

function setFeedback(isCorrect){
  if(isCorrect===true){
    feedback.textContent='✅ Betul!';
    feedback.className='feedback ok';
  } else if(isCorrect===false){
    feedback.textContent='❌ Salah. Cuba semula atau teruskan.';
    feedback.className='feedback bad';
  } else {
    feedback.textContent='';
    feedback.className='feedback';
  }
}

btnCheck.onclick=()=>{
  const sel=getSelected();
  if(sel===null){
    feedback.textContent='Sila pilih jawapan dahulu.';
    feedback.className='feedback bad';
    return;
  }
  const q=questions[idx];
  const correct=sel===q.correctIndex;
  if(answered[idx]===null){
    if(correct) score++;
    answered[idx]={sel,correct};
  } else {
    if(answered[idx].correct && !correct) score--;
    if(!answered[idx].correct && correct) score++;
    answered[idx]={sel,correct};
  }
  setFeedback(correct);
  scoreBox.textContent=`Markah semasa: ${score} / ${questions.length}`;
};

btnPrev.onclick=()=>{ idx=Math.max(0,idx-1); render(); };
btnNext.onclick=()=>{ idx=Math.min(questions.length-1,idx+1); render(); };

btnRestart.onclick=()=>{
  localStorage.setItem('lastQuestion', idx);
  const file=`jalan_kira${idx+1}.html`;
  window.location.href=file;
};

render();
</script>
</body>
</html>
